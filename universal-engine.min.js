(function(){"use strict";function q(el){while(el&&el!==document){if(el.classList&&el.classList.contains("ue-question"))return el;el=el.parentNode}return null}function initMCQ(){var a=document.querySelectorAll(".ue-option");for(var i=0;i<a.length;i++)(function(btn){btn.addEventListener("click",function(){var qid=btn.getAttribute("data-question-id")||"";if(!qid)return;var sib=document.querySelectorAll('.ue-option[data-question-id="'+qid+'"]');for(var j=0;j<sib.length;j++)sib[j].classList.remove("ue-selected"),sib[j].style.backgroundColor="",sib[j].style.borderColor="";btn.classList.add("ue-selected");var correct=(btn.getAttribute("data-correct")||"").toLowerCase()==="true";if(correct){btn.style.backgroundColor="#dcfce7";btn.style.borderColor="#16a34a"}else{btn.style.backgroundColor="#fee2e2";btn.style.borderColor="#dc2626"}var qEl=q(btn);if(qEl){qEl.setAttribute("data-is-correct",correct?"true":"false");qEl.setAttribute("data-selected-option-id",btn.getAttribute("data-option-id")||"")}})})(a[i])}function checkDnd(cont){var keyStr=cont.getAttribute("data-correct-order")||"";if(!keyStr)return;var key=keyStr.split(",");for(var i=0;i<key.length;i++)key[i]=key[i].replace(/^\s+|\s+$/g,"");var items=cont.querySelectorAll(".ue-dnd-item"),arr=[];for(var j=0;j<items.length;j++){var v=(items[j].getAttribute("data-value")||"").replace(/^\s+|\s+$/g,"");arr.push(v)}var ok=arr.length===key.length;if(ok)for(var k=0;k<key.length;k++)if(arr[k]!==key[k]){ok=false;break}if(ok){cont.style.outline="2px solid #16a34a";cont.style.boxShadow="0 0 0 4px rgba(22,163,74,0.20)";cont.setAttribute("data-is-correct","true")}else{cont.style.outline="2px solid #dc2626";cont.style.boxShadow="0 0 0 4px rgba(220,38,38,0.20)";cont.setAttribute("data-is-correct","false")}}function getAfterElement(list,x,y){var items=list.querySelectorAll(".ue-dnd-item:not(.ue-dragging)");if(!items.length)return null;var closest=null,minDist=Infinity;for(var i=0;i<items.length;i++){var box=items[i].getBoundingClientRect(),cx=box.left+box.width/2,cy=box.top+box.height/2,dx=x-cx,dy=y-cy,dist=dx*dx+dy*dy;if(dist<minDist){minDist=dist;closest=items[i]}}return closest}function initDnd(){var containers=document.querySelectorAll(".ue-dnd-container");for(var i=0;i<containers.length;i++)(function(cont){var list=cont.querySelector(".ue-dnd-list")||cont.querySelector("ul")||cont.querySelector("ol");if(!list)return;var items=list.querySelectorAll(".ue-dnd-item");for(var j=0;j<items.length;j++)(function(item){item.draggable=true;item.addEventListener("dragstart",function(ev){item.classList.add("ue-dragging");try{ev.dataTransfer.effectAllowed="move";ev.dataTransfer.setData("text/plain",item.getAttribute("data-value")||"")}catch(e){}});item.addEventListener("dragend",function(){item.classList.remove("ue-dragging")})})(items[j]);list.addEventListener("dragover",function(ev){ev.preventDefault();var dragging=list.querySelector(".ue-dragging");if(!dragging)return;var after=getAfterElement(list,ev.clientX,ev.clientY);if(after==null)list.appendChild(dragging);else if(after!==dragging)list.insertBefore(dragging,after)});list.addEventListener("drop",function(ev){ev.preventDefault();checkDnd(cont)})})(containers[i])}function init(){initMCQ();initDnd()}if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",init);else init()})();
