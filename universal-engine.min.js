(function(){"use strict";function a(e,t){return Array.prototype.slice.call((t||document).querySelectorAll(e))}function b(e){var t=a(".ue-option",e);t.forEach(function(c){c.addEventListener("click",function(){t.forEach(function(d){d.classList.remove("selected")});c.classList.add("selected"),e.classList.remove("ue-correct","ue-incorrect")})})}function c(e){var t=a(".ue-option",e),c=t.filter(function(f){return f.dataset.correct==="1"}),d=t.filter(function(f){return f.classList.contains("selected")});e.classList.remove("ue-correct","ue-incorrect");if(c.length===0||d.length===0){e.classList.add("ue-incorrect");return!1}var g=d.length===1&&d[0]===c[0];g?e.classList.add("ue-correct"):e.classList.add("ue-incorrect");return g}function d(e){var t=a(".ue-drag",e);t.forEach(function(r){r.addEventListener("dragstart",function(s){r.classList.add("ue-dragging"),s.dataTransfer.effectAllowed="move"}),r.addEventListener("dragend",function(){r.classList.remove("ue-dragging")})}),e.addEventListener("dragover",function(r){r.preventDefault();var s=f(e,r.clientX),o=e.querySelector(".ue-dragging");o&&(s==null?e.appendChild(o):e.insertBefore(o,s))})}function f(e,t){var c=a(".ue-drag:not(.ue-dragging)",e),d=-1/0,f=null;return c.forEach(function(h){var i=h.getBoundingClientRect(),j=t-(i.left+i.width/2);j<0&&j>d&&(d=j,f=h)}),f}function g(e){var t=e.querySelector(".ue-drag-container");e.classList.remove("ue-correct","ue-incorrect");if(!t){e.classList.add("ue-incorrect");return!1}var c=(t.dataset.correctOrder||"").split(",").map(function(o){return o.trim()}).filter(Boolean),d=a(".ue-drag",t).map(function(o){return(o.dataset.value||"").trim()});if(c.length===0||c.length!==d.length){e.classList.add("ue-incorrect");return!1}for(var f=!0,h=0;h<c.length;h++)if(c[h]!==d[h]){f=!1;break}return f?e.classList.add("ue-correct"):e.classList.add("ue-incorrect"),f}function h(e){var t=a(".ue-question",e),c=0;t.forEach(function(o){var r=o.dataset.qtype||"",s=!1;r==="mcq"?s=cFn.mcq(o):r==="drag-sort"&&(s=g(o)),s&&c++});var d=t.length,f=e.querySelector(".ue-score")||document.getElementById("ueScore");f&&(f.textContent="Score: "+c+" / "+d),i(c,d)}function i(e,t){try{var c=document.getElementById("score-input"),d=document.getElementById("feedback-input"),f="Score "+e+" / "+t;c&&(c.value=String(e)),d&&(d.value=f),typeof updateStore=="function"?updateStore():typeof storeState=="function"&&storeState({score:e,feedback:f})}catch(o){}}var cFn={mcq:c};function j(e){a(".ue-question",e).forEach(function(t){var c=t.dataset.qtype||"";c==="mcq"?b(t):c==="drag-sort"&&t.querySelector(".ue-drag-container")&&d(t.querySelector(".ue-drag-container"))});var t=e.querySelector(".ue-check-all");t&&t.addEventListener("click",function(){h(e)})}document.addEventListener("DOMContentLoaded",function(){a(".ue-activity").forEach(j)});}());
